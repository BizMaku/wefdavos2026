<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Intake + Remember Me</title>

  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; padding: 24px; background:#0b0f18; color:#e8eefc; }
    .wrap { max-width: 980px; margin: 0 auto; }
    .card { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.10); border-radius: 16px; padding: 20px; }
    h1 { margin: 0 0 10px; font-size: 22px; }
    p { margin: 0 0 16px; color: rgba(232,238,252,0.85); }
    label { display:block; margin: 12px 0 6px; font-weight: 600; }
    input, select, textarea {
      width: 100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(0,0,0,0.25);
      color: #e8eefc;
      outline: none;
    }
    input::placeholder, textarea::placeholder { color: rgba(232,238,252,0.55); }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 720px){ .row{ grid-template-columns:1fr; } }

    .btns { display:flex; gap:10px; flex-wrap: wrap; margin-top: 16px; }
    button {
      border: 0;
      border-radius: 12px;
      padding: 12px 14px;
      font-weight: 700;
      cursor: pointer;
      background: #4f7cff;
      color: #06102a;
    }
    button.secondary { background: rgba(255,255,255,0.12); color:#e8eefc; border:1px solid rgba(255,255,255,0.16); }
    .small { font-size: 13px; color: rgba(232,238,252,0.75); margin-top: 10px; }
    .hidden { display:none !important; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; background: rgba(79,124,255,0.18); border: 1px solid rgba(79,124,255,0.35); color:#dbe6ff; font-weight:700; font-size:12px; }
    .kv { display:grid; grid-template-columns: 160px 1fr; gap:8px 14px; margin-top: 12px; }
    .kv div { padding: 10px 12px; border-radius: 12px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.10); }
    .kv .k { color: rgba(232,238,252,0.75); font-weight:700; }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- VIEW A: Intake Form (shown only if user has no saved intake) -->
    <section id="intakeView" class="card hidden">
      <h1>Quick Intake</h1>
      <p>Fill this once. Next time you come back, weâ€™ll remember it on this device.</p>

      <form id="intakeForm">
        <!-- Replace these fields with YOUR real intake form fields -->
        <div class="row">
          <div>
            <label for="firstName">First name</label>
            <input id="firstName" name="firstName" placeholder="e.g., Jose" required />
          </div>
          <div>
            <label for="lastName">Last name</label>
            <input id="lastName" name="lastName" placeholder="e.g., Prado" required />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="you@email.com" required />
          </div>
          <div>
            <label for="country">Country</label>
            <input id="country" name="country" placeholder="e.g., Honduras" />
          </div>
        </div>

        <label for="interest">What are you here for?</label>
        <select id="interest" name="interest" required>
          <option value="" disabled selected>Select one</option>
          <option>Events</option>
          <option>Networking</option>
          <option>VIP Access</option>
          <option>Other</option>
        </select>

        <label for="notes">Notes (optional)</label>
        <textarea id="notes" name="notes" rows="4" placeholder="Anything we should know?"></textarea>

        <div class="btns">
          <button type="submit">Continue</button>
          <button type="button" class="secondary" id="clearBtn">Reset</button>
        </div>

        <div class="small">
          Saved locally on this device using localStorage. If you switch devices or clear browser data, youâ€™ll need to fill it again.
        </div>
      </form>
    </section>

    <!-- VIEW B: Main Site Content (shown after intake exists) -->
    <section id="mainView" class="card hidden">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;">
        <div>
          <span class="pill">Welcome back</span>
          <h1 style="margin-top:10px;">Youâ€™re in ðŸŽ‰</h1>
          <p id="welcomeLine">Loading your infoâ€¦</p>
        </div>

        <div class="btns" style="margin-top:0;">
          <button type="button" class="secondary" id="editBtn">Edit details</button>
          <button type="button" class="secondary" id="forgetBtn">Forget this device</button>
        </div>
      </div>

      <!-- Optional: Show saved intake summary -->
      <div id="summary" class="kv"></div>

      <hr style="border:0; border-top:1px solid rgba(255,255,255,0.12); margin:18px 0;" />

      <!-- âœ… Put your actual site here (events guide, dashboard, etc.) -->
      <div id="siteContent">
        <h2 style="margin:0 0 10px;">Main Content</h2>
        <p style="margin:0; color:rgba(232,238,252,0.85);">
          Replace this section with your Art Basel / Davos page content.
        </p>
      </div>
    </section>

  </div>

  <script>
    /**
     * Simple "remember intake" using localStorage.
     * - Stores form values on submit
     * - On load: if data exists, skip intake form and show main content
     */

    const STORAGE_KEY = "intake:v1";

    const intakeView = document.getElementById("intakeView");
    const mainView   = document.getElementById("mainView");

    const intakeForm = document.getElementById("intakeForm");
    const clearBtn   = document.getElementById("clearBtn");

    const welcomeLine = document.getElementById("welcomeLine");
    const summaryEl   = document.getElementById("summary");

    const editBtn   = document.getElementById("editBtn");
    const forgetBtn = document.getElementById("forgetBtn");

    function show(el) { el.classList.remove("hidden"); }
    function hide(el) { el.classList.add("hidden"); }

    function safeParse(json) {
      try { return JSON.parse(json); } catch { return null; }
    }

    function getSavedIntake() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return null;
      const parsed = safeParse(raw);
      // Basic shape check
      if (!parsed || typeof parsed !== "object") return null;
      return parsed;
    }

    function saveIntake(data) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify({
        ...data,
        savedAt: new Date().toISOString()
      }));
    }

    function clearIntake() {
      localStorage.removeItem(STORAGE_KEY);
    }

    function formToObject(form) {
      const fd = new FormData(form);
      const obj = {};
      for (const [k, v] of fd.entries()) obj[k] = String(v).trim();
      return obj;
    }

    function fillFormFromSaved(saved) {
      // Fill known fields back into the form
      for (const [key, value] of Object.entries(saved)) {
        const input = intakeForm.querySelector(`[name="${CSS.escape(key)}"]`);
        if (input && (input.tagName === "INPUT" || input.tagName === "TEXTAREA" || input.tagName === "SELECT")) {
          input.value = value;
        }
      }
    }

    function renderMain(saved) {
      const name = [saved.firstName, saved.lastName].filter(Boolean).join(" ").trim() || "there";
      welcomeLine.textContent = `Good to see you again, ${name}.`;

      // Render summary (optional)
      const rows = [
        ["Name", name],
        ["Email", saved.email || "â€”"],
        ["Country", saved.country || "â€”"],
        ["Interest", saved.interest || "â€”"],
      ];

      summaryEl.innerHTML = rows.map(([k, v]) => `
        <div class="k">${k}</div>
        <div>${escapeHtml(v)}</div>
      `).join("");

      hide(intakeView);
      show(mainView);
    }

    function renderIntake() {
      hide(mainView);
      show(intakeView);
    }

    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    // On load, decide which view to show
    (function init() {
      const saved = getSavedIntake();
      if (saved) renderMain(saved);
      else renderIntake();
    })();

    // Save intake & continue
    intakeForm.addEventListener("submit", (e) => {
      e.preventDefault();

      const data = formToObject(intakeForm);

      // Example required fields check (keep or remove as needed)
      if (!data.firstName || !data.lastName || !data.email || !data.interest) {
        alert("Please complete the required fields.");
        return;
      }

      saveIntake(data);
      renderMain(getSavedIntake());
    });

    // Reset button on form
    clearBtn.addEventListener("click", () => {
      intakeForm.reset();
      clearIntake();
      renderIntake();
    });

    // Edit details (brings them back to form with saved values filled)
    editBtn.addEventListener("click", () => {
      const saved = getSavedIntake();
      if (!saved) return renderIntake();

      renderIntake();
      fillFormFromSaved(saved);
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Forget device (clears localStorage and forces form next time)
    forgetBtn.addEventListener("click", () => {
      clearIntake();
      renderIntake();
      intakeForm.reset();
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
  </script>
</body>
</html>
